(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{95:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return p})),a.d(t,"metadata",(function(){return u})),a.d(t,"toc",(function(){return m})),a.d(t,"default",(function(){return f}));var n=a(3),r=a(7),s=a(0),l=a.n(s),i=a(104);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function c(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}var b=function(e){if(!e||0===e.length)return"";var t="",a=null==e?void 0:e.indexOf("?");if(a>0){t+=e.slice(0,a+1)+"\n";for(var n,r=0,s=c(e.slice(a+1).split("&"));!(n=s()).done;){var l=n.value,i=l.indexOf("="),o=l.slice(0,i),b=decodeURIComponent(l.slice(i+1));r&&(t+=" &\n"),r++;try{t+=o+"="+JSON.stringify(JSON.parse(b)," ",2)+"\n"}catch(d){b.includes("{")||b.includes("[")||b.includes('"')?t+="<cannot parse: '"+o+"="+b+"' as JSON>":t+=o+"="+b}}}else t=e;return t};function d(){var e=Object(s.useState)("/get/docs/0/filters?query=%5B%5D"),t=e[0],a=e[1],n=Object(s.useState)(b("")),r=n[0],i=n[1],o=Object(s.useState)(""),d=o[0],p=o[1];return Object(s.useEffect)((function(){var e=b(t);e!==r&&i(e)}),[t]),Object(s.useEffect)((function(){try{var e=function(e){var t="",a=null==e?void 0:e.indexOf("?");if(a>0){t+=e.slice(0,a+1);for(var n,r=0,s=c(e.slice(a+1).split("&\n"));!(n=s()).done;){var l=n.value,i=(l=l.replace(/^\s+|\s+$/g,"")).indexOf("=");if(r&&(t+="&"),r++,i>=0){var o=l.slice(0,i),b=l.slice(i+1);try{t+=o+"="+encodeURIComponent(JSON.stringify(JSON.parse(b)))}catch(d){b.includes("{")||b.includes("[")||b.includes('"')?t+="&<cannot parse: '"+o+"="+b+"' as JSON>":t+=o+"="+b}}else t+=""+l}}else t=e;return t}(r);e!==d&&p(e)}catch(t){}}),[r]),l.a.createElement("form",null,l.a.createElement("label",null,"DLT-Logs rest query (URI encoded):",l.a.createElement("br",null),l.a.createElement("textarea",{cols:80,rows:20,value:t,placeholder:"enter your dlt-logs rest query expression here",type:"text",name:"payloadRegex",onChange:function(e){return a(e.target.value)}})),l.a.createElement("div",null),l.a.createElement("label",null,"DLT-Logs rest query (URI decoded, after & as command sep. a new line has to follow):",l.a.createElement("br",null),l.a.createElement("textarea",{cols:80,rows:30,type:"text",value:r,onChange:function(e){return i(e.target.value)}})),l.a.createElement("div",null),l.a.createElement("label",null,"DLT-Logs rest query (URI re-encoded):",t!==d?" modified!":"",l.a.createElement("br",null),l.a.createElement("textarea",{readOnly:!0,cols:80,rows:20,type:"text",value:d})))}var p={id:"badges",title:"Badges",sidebar_label:"Badges"},u={unversionedId:"badges",id:"badges",isDocsHomePage:!1,title:"Badges",description:"Overview",source:"@site/docs/badges.md",slug:"/badges",permalink:"/fishbone/docs/badges",editUrl:"https://github.com/mbehr1/fishbone/edit/master/docs/fishbone/docs/badges.md",version:"current",sidebar_label:"Badges",sidebar:"fishboneSideBar",previous:{title:"Interactive diagrams",permalink:"/fishbone/docs/interactive"},next:{title:"Nested fishbone charts",permalink:"/fishbone/docs/nestedFishbones"}},m=[{value:"Overview",id:"overview",children:[]},{value:"Badges using DLT-Logs extensions",id:"badges-using-dlt-logs-extensions",children:[{value:"returned data from a DLT-Logs rest query:",id:"returned-data-from-a-dlt-logs-rest-query",children:[]},{value:"json path details",id:"json-path-details",children:[]},{value:"javascript function details",id:"javascript-function-details",children:[]},{value:"javascript function examples",id:"javascript-function-examples",children:[]},{value:"URI-De-/Encoder",id:"uri-de-encoder",children:[]}]},{value:"Badges using https rest-queries",id:"badges-using-https-rest-queries",children:[]}],j={toc:m};function f(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},j,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"overview"},"Overview"),Object(i.b)("p",null,"Badges are little indicators (similar like number of messages on mobile phone icons) providing a quick way to show data and capture your attention."),Object(i.b)("p",null,"todo: add picture"),Object(i.b)("p",null,"Each root-cause supports two badges:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"upper left badge. Shown in red color."),Object(i.b)("li",{parentName:"ul"},"lower left badge, shown in secondary color.")),Object(i.b)("p",null,"Badges receive their info from currently two sources:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"DLT-Logs extension"),Object(i.b)("li",{parentName:"ul"},"https rest-queries.")),Object(i.b)("h2",{id:"badges-using-dlt-logs-extensions"},"Badges using DLT-Logs extensions"),Object(i.b)("p",null,"With DLT-Logs extension the following use-cases are supported:"),Object(i.b)("p",null,"Show information in any of the badges: "),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"based on number of messages matching a set of DLT-filters on the currently opened DLT-file"),Object(i.b)("li",{parentName:"ul"},"based on message attributes usually from the first message filtered"),Object(i.b)("li",{parentName:"ul"},"based on applying a user-defined Javascript on the messages returned from a query of a set of DLT-filters.")),Object(i.b)("p",null,"To use a badge perform the following steps:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},Object(i.b)("strong",{parentName:"p"},"edit")," a root-cause (press the small pen icon on a root cause in the fishbone)")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"press the ",Object(i.b)("strong",{parentName:"p"},"edit upper left badge")," or *lower right badge** button")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"select the ",Object(i.b)("strong",{parentName:"p"},"extension dlt-logs rest query")," button")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"press the ",Object(i.b)("strong",{parentName:"p"},"OPEN DLT FILTER ASSISTANT...")," button")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"select the filters you want to use on the right hand side ",Object(i.b)("strong",{parentName:"p"},"All available filters:"),"."),Object(i.b)("div",Object(n.a)({parentName:"li"},{className:"admonition admonition-note alert alert--secondary"}),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If the list is empty you do need to open a DLT log file and configure your filters there first.")))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"press the ",Object(i.b)("inlineCode",{parentName:"p"},"<"),"button to move those filters to the ",Object(i.b)("strong",{parentName:"p"},"Selected filters:")," list.")),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"press ",Object(i.b)("strong",{parentName:"p"},"SAVE CHANGES"))),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},'specify the "jsonPath" expression to extract results. For the "number of messages" use-case the jsonPath expression is already prefilled. See (todo) for details.')),Object(i.b)("li",{parentName:"ol"},Object(i.b)("p",{parentName:"li"},"select whether you want to use "),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"number of array elements or"),Object(i.b)("li",{parentName:"ul"},"data from first element or "),Object(i.b)("li",{parentName:"ul"},"a javascript function")),Object(i.b)("p",{parentName:"li"},"to get the data out of the returned DLT-filter results."))),Object(i.b)("h3",{id:"returned-data-from-a-dlt-logs-rest-query"},"returned data from a DLT-Logs rest query:"),Object(i.b)("p",null,"The returned data from a rest query is in general a JSON object. "),Object(i.b)("p",null,"For a query with DLT-filters it's typically in the form of an object with a key ",Object(i.b)("inlineCode",{parentName:"p"},"data")," that is an array of messages like:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsonc"}),'{\n  "data": [\n    {\n        "id": 10,\n        "type": "msg",\n        "attributes": {\n            "timeStamp": 18283269,\n            "ecu": "ECU1",\n            "apid": "SYS",\n            "ctid": "CTI1",\n            "payloadString": "Example SYS CTI1 message payload...",\n            "lifecycle": 1585216860833.6\n        }\n    },\n    {\n        "id": 68,\n        "type": "msg",\n        "attributes": {\n            "timeStamp": 18304306,\n            "ecu": "ECU1",\n            "apid": "SYS",\n            "ctid": "CTI1",\n            "payloadString": "Another example SYS CTI1 message payload...",\n            "lifecycle": 1585216860833.6\n        },\n    }\n    // more msgs to follow\n    ]\n}\n')),Object(i.b)("h3",{id:"json-path-details"},"json path details"),Object(i.b)("p",null,"As a first step of processing the returned object can be processed with a ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://goessner.net/articles/JsonPath/index.html"}),"json path")," pre-processor."),Object(i.b)("p",null,"E.g. to get the ",Object(i.b)("inlineCode",{parentName:"p"},"data")," array elements simply use:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*]\n")),Object(i.b)("p",null,"or if you're only interested in the attributes:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*].attributes\n")),Object(i.b)("p",null,"or for the ",Object(i.b)("inlineCode",{parentName:"p"},"payloadString"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*].attributes.payloadString\n")),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"If you're not used to json path expressions there is a online evaluator available here ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://jsonpath.com"}),"jsonpath"),"."))),Object(i.b)("h3",{id:"javascript-function-details"},"javascript function details"),Object(i.b)("p",null,"If the the number of messages or the first element from the json path expression is not sufficient e.g. for use-cases like:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"calculate an average/min/max value"),Object(i.b)("li",{parentName:"ul"},"calculate the distinct set of values e.g. different SW versions"),Object(i.b)("li",{parentName:"ul"},"extract/shorten the result"),Object(i.b)("li",{parentName:"ul"},"find lifecycles where messages matching exactly one of multiple filters"),Object(i.b)("li",{parentName:"ul"},"...")),Object(i.b)("p",null,"a user-provided javascript function body can be entered."),Object(i.b)("p",null,"The function prototype is in the form of:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"function (result: object|any[] ):string|number|object {\n    <body text>\n}\n")),Object(i.b)("p",null,"It's actually created, called and evalued internally with:"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"    const fn = new Function(\"result\", '<entered body text>');\n    const fnRes = fn(result); // call the function\n    switch (typeof fnRes) { // which type was returned:\n        case 'string': answer.convResult = fnRes; break;\n        case 'number': answer.convResult = fnRes; break;\n        case 'object': answer.convResult = JSON.stringify(fnRes); break;\n    ...\n")),Object(i.b)("p",null,"The result from the rest query or if provided from the json path processor is passed to the javascript function as ",Object(i.b)("inlineCode",{parentName:"p"},"result")," parameter."),Object(i.b)("h3",{id:"javascript-function-examples"},"javascript function examples"),Object(i.b)("p",null,"See here a few examples:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"provide from the first 3 results the substring from index 10 to 15 separated by ',':")),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"   return result.slice(0,3).map(r=>r.slice(10,15)).join(',');\n")),Object(i.b)("p",null,"todo ... add more examples."),Object(i.b)("h3",{id:"uri-de-encoder"},"URI-De-/Encoder"),Object(i.b)("p",null,'As the communication from fishbone extension to DLT-Logs extension is via a rest-api alike "restQuery" the query gets transmitted and stored in a URI encoded format.'),Object(i.b)("p",null,"To ease decoding and fast manual edits you can enter/modify the query below:"),Object(i.b)(d,{mdxType:"UriEnDecode"}),Object(i.b)("h2",{id:"badges-using-https-rest-queries"},"Badges using https rest-queries"))}f.isMDXComponent=!0}}]);