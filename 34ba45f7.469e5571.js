(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{95:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return d})),a.d(t,"metadata",(function(){return u})),a.d(t,"toc",(function(){return m})),a.d(t,"default",(function(){return h}));var n=a(3),r=a(7),s=a(0),i=a.n(s),o=a(104);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function c(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return l(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}var b=function(e){if(!e||0===e.length)return"";var t="",a=null==e?void 0:e.indexOf("?");if(a>0){t+=e.slice(0,a+1)+"\n";for(var n,r=0,s=c(e.slice(a+1).split("&"));!(n=s()).done;){var i=n.value,o=i.indexOf("="),l=i.slice(0,o),b=decodeURIComponent(i.slice(o+1));r&&(t+=" &\n"),r++;try{t+=l+"="+JSON.stringify(JSON.parse(b)," ",2)+"\n"}catch(p){b.includes("{")||b.includes("[")||b.includes('"')?t+="<cannot parse: '"+l+"="+b+"' as JSON>":t+=l+"="+b}}}else t=e;return t};function p(){var e=Object(s.useState)("/get/docs/0/filters?query=%5B%5D"),t=e[0],a=e[1],n=Object(s.useState)(b("")),r=n[0],o=n[1],l=Object(s.useState)(""),p=l[0],d=l[1];return Object(s.useEffect)((function(){var e=b(t);e!==r&&o(e)}),[t]),Object(s.useEffect)((function(){try{var e=function(e){var t="",a=null==e?void 0:e.indexOf("?");if(a>0){t+=e.slice(0,a+1);for(var n,r=0,s=c(e.slice(a+1).split("&\n"));!(n=s()).done;){var i=n.value,o=(i=i.replace(/^\s+|\s+$/g,"")).indexOf("=");if(r&&(t+="&"),r++,o>=0){var l=i.slice(0,o),b=i.slice(o+1);try{t+=l+"="+encodeURIComponent(JSON.stringify(JSON.parse(b)))}catch(p){b.includes("{")||b.includes("[")||b.includes('"')?t+="&<cannot parse: '"+l+"="+b+"' as JSON>":t+=l+"="+b}}else t+=""+i}}else t=e;return t}(r);e!==p&&d(e)}catch(t){}}),[r]),i.a.createElement("form",null,i.a.createElement("label",null,"DLT-Logs rest query (URI encoded):",i.a.createElement("br",null),i.a.createElement("textarea",{cols:80,rows:20,value:t,placeholder:"enter your dlt-logs rest query expression here",type:"text",name:"payloadRegex",onChange:function(e){return a(e.target.value)}})),i.a.createElement("div",null),i.a.createElement("label",null,"DLT-Logs rest query (URI decoded, after & as command sep. a new line has to follow):",i.a.createElement("br",null),i.a.createElement("textarea",{cols:80,rows:30,type:"text",value:r,onChange:function(e){return o(e.target.value)}})),i.a.createElement("div",null),i.a.createElement("label",null,"DLT-Logs rest query (URI re-encoded):",t!==p?" modified!":"",i.a.createElement("br",null),i.a.createElement("textarea",{readOnly:!0,cols:80,rows:20,type:"text",value:p})))}var d={id:"badges",title:"Badges",sidebar_label:"Badges"},u={unversionedId:"badges",id:"badges",isDocsHomePage:!1,title:"Badges",description:"Overview",source:"@site/docs/badges.md",slug:"/badges",permalink:"/fishbone/docs/badges",editUrl:"https://github.com/mbehr1/fishbone/edit/master/docs/fishbone/docs/badges.md",version:"current",sidebar_label:"Badges",sidebar:"fishboneSideBar",previous:{title:"Interactive diagrams",permalink:"/fishbone/docs/interactive"},next:{title:"Nested fishbone charts",permalink:"/fishbone/docs/nestedFishbones"}},m=[{value:"Overview",id:"overview",children:[]},{value:"Badges using DLT-Logs extensions",id:"badges-using-dlt-logs-extensions",children:[{value:"Data returned from a DLT-Logs rest query:",id:"data-returned-from-a-dlt-logs-rest-query",children:[]},{value:"Json path details",id:"json-path-details",children:[]},{value:"Javascript function details",id:"javascript-function-details",children:[]},{value:"Javascript function examples",id:"javascript-function-examples",children:[]},{value:"URI-De-/Encoder",id:"uri-de-encoder",children:[]}]},{value:"Badges using https rest-queries",id:"badges-using-https-rest-queries",children:[]}],j={toc:m};function h(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},j,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"overview"},"Overview"),Object(o.b)("p",null,"Badges are little indicators (similar like number of messages on mobile phone icons) providing a quick way to show data and capture your attention."),Object(o.b)("p",null,"todo: add picture"),Object(o.b)("p",null,"Each root-cause supports two badges:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"upper left badge. Shown in red color."),Object(o.b)("li",{parentName:"ul"},"lower left badge, shown in secondary color.")),Object(o.b)("p",null,"Badges receive their info from currently two sources:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"DLT-Logs extension"),Object(o.b)("li",{parentName:"ul"},"https rest-queries.")),Object(o.b)("h2",{id:"badges-using-dlt-logs-extensions"},"Badges using DLT-Logs extensions"),Object(o.b)("p",null,"With DLT-Logs extension the following use-cases are supported:"),Object(o.b)("p",null,"Show information in any of the badges: "),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"based on number of messages matching a set of DLT-filters on the currently opened DLT-file"),Object(o.b)("li",{parentName:"ul"},"based on message attributes usually from the first message filtered"),Object(o.b)("li",{parentName:"ul"},"based on applying a user-defined Javascript on the messages returned from a query of a set of DLT-filters.")),Object(o.b)("p",null,"To use a badge perform the following steps:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"edit")," a root-cause (press the small pen icon on a root cause in the fishbone)")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"press the ",Object(o.b)("strong",{parentName:"p"},"edit upper left badge")," or *lower right badge** button")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"select the ",Object(o.b)("strong",{parentName:"p"},"extension dlt-logs rest query")," button")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"press the ",Object(o.b)("strong",{parentName:"p"},"OPEN DLT FILTER ASSISTANT...")," button")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"select the filters you want to use on the right hand side ",Object(o.b)("strong",{parentName:"p"},"All available filters:"),"."),Object(o.b)("div",Object(n.a)({parentName:"li"},{className:"admonition admonition-note alert alert--secondary"}),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"If the list is empty you do need to open a DLT log file and configure your filters there first.")))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"press the ",Object(o.b)("inlineCode",{parentName:"p"},"<"),"button to move those filters to the ",Object(o.b)("strong",{parentName:"p"},"Selected filters:")," list.")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"press ",Object(o.b)("strong",{parentName:"p"},"SAVE CHANGES"))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},'specify the "jsonPath" expression to extract results. For the "number of messages" use-case the jsonPath expression is already prefilled. See (todo) for details.')),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"select whether you want to use "),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"number of array elements or"),Object(o.b)("li",{parentName:"ul"},"data from first element or "),Object(o.b)("li",{parentName:"ul"},"a javascript function")),Object(o.b)("p",{parentName:"li"},"to get the data out of the returned DLT-filter results."))),Object(o.b)("div",{className:"admonition admonition-info alert alert--info"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"info")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"The upper badge is configured to not show if the returned value is the number 0.\nIf you want to show it anyhow see ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"#javascript-function-examples"}),"examples")," on how to convert to the string '0'."))),Object(o.b)("h3",{id:"data-returned-from-a-dlt-logs-rest-query"},"Data returned from a DLT-Logs rest query:"),Object(o.b)("p",null,"The returned data from a rest query is in general a JSON object. "),Object(o.b)("p",null,"For a query with DLT-filters it's typically in the form of an object with a key ",Object(o.b)("inlineCode",{parentName:"p"},"data")," that is an array of messages like:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-jsonc"}),'{\n  "data": [\n    {\n        "id": 10,\n        "type": "msg",\n        "attributes": {\n            "timeStamp": 18283269,\n            "ecu": "ECU1",\n            "apid": "SYS",\n            "ctid": "CTI1",\n            "payloadString": "Example SYS CTI1 message payload...",\n            "lifecycle": 1585216860833.6\n        }\n    },\n    {\n        "id": 68,\n        "type": "msg",\n        "attributes": {\n            "timeStamp": 18304306,\n            "ecu": "ECU1",\n            "apid": "SYS",\n            "ctid": "CTI1",\n            "payloadString": "Another example SYS CTI1 message payload...",\n            "lifecycle": 1585216860833.6\n        },\n    }\n    // more msgs to follow\n    ]\n}\n')),Object(o.b)("h3",{id:"json-path-details"},"Json path details"),Object(o.b)("p",null,"As a first step of processing the returned object can be processed with a ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://goessner.net/articles/JsonPath/index.html"}),"json path")," pre-processor."),Object(o.b)("p",null,"E.g. to get the ",Object(o.b)("inlineCode",{parentName:"p"},"data")," array elements simply use:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*]\n")),Object(o.b)("p",null,"or if you're only interested in the attributes:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*].attributes\n")),Object(o.b)("p",null,"or for the ",Object(o.b)("inlineCode",{parentName:"p"},"payloadString"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),"$.data[*].attributes.payloadString\n")),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"If you're not used to json path expressions there is a online evaluator available here ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://jsonpath.com"}),"jsonpath"),"."))),Object(o.b)("h3",{id:"javascript-function-details"},"Javascript function details"),Object(o.b)("p",null,"If the the number of messages or the first element from the json path expression is not sufficient e.g. for use-cases like:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"calculate an average/min/max value"),Object(o.b)("li",{parentName:"ul"},"calculate the distinct set of values e.g. different SW versions"),Object(o.b)("li",{parentName:"ul"},"extract/shorten the result"),Object(o.b)("li",{parentName:"ul"},"find lifecycles where messages matching exactly one of multiple filters"),Object(o.b)("li",{parentName:"ul"},"...")),Object(o.b)("p",null,"a user-provided javascript function body can be entered."),Object(o.b)("p",null,"The function prototype is in the form of:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-typescript"}),"function (result: object|any[] ):string|number|object {\n    <body text>\n}\n")),Object(o.b)("p",null,"It's actually created, called and evalued internally with:"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"    const fn = new Function(\"result\", '<entered body text>');\n    const fnRes = fn(result); // call the function\n    switch (typeof fnRes) { // which type was returned:\n        case 'string': answer.convResult = fnRes; break;\n        case 'number': answer.convResult = fnRes; break;\n        case 'object': answer.convResult = JSON.stringify(fnRes); break;\n    ...\n")),Object(o.b)("p",null,"The result from the rest query or if provided from the json path processor is passed to the javascript function as ",Object(o.b)("inlineCode",{parentName:"p"},"result")," parameter."),Object(o.b)("h3",{id:"javascript-function-examples"},"Javascript function examples"),Object(o.b)("p",null,"See here a few examples:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"provide from the first 3 results the substring from index 10 to 15 separated by ',':")),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"   return result.slice(0,3).map(r=>r.slice(10,15)).join(',');\n")),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"show 0 for number of message, i.e. convert to string as result:")),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-javascript"}),"    return result.length.toString();\n")),Object(o.b)("p",null,"todo ... add more examples."),Object(o.b)("h3",{id:"uri-de-encoder"},"URI-De-/Encoder"),Object(o.b)("p",null,'As the communication from fishbone extension to DLT-Logs extension is via a rest-api alike "restQuery" the query gets transmitted and stored in a URI encoded format.'),Object(o.b)("p",null,"To ease decoding and fast manual edits you can enter/modify the query below:"),Object(o.b)(p,{mdxType:"UriEnDecode"}),Object(o.b)("h2",{id:"badges-using-https-rest-queries"},"Badges using https rest-queries"))}h.isMDXComponent=!0}}]);